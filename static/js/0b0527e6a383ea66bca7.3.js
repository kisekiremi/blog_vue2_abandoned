(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{U0gS:function(t,e,r){"use strict";r.r(e);var i=r("WIBD"),n=r("yyRi"),o=r("xGzH");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l={components:{TokenDialog:n.a},data:function(){return{form:{id:"",title:"",description:"",content:""},ruleValidate:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{type:"string",max:32,message:"标题长度不大于32字符",trigger:"change"}],description:[{required:!0,message:"请输入博客描述",trigger:"blur"}],content:[{required:!0,message:"请输博客入正文",trigger:"blur"}]},loading:!0,submitButton:{loading:!1,disabled:!1},mavonEditorToolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,htmlcode:!0,trash:!0,alignleft:!0,aligncenter:!0,alignright:!0,preview:!0}}},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},Object(i.mapGetters)(["token"])),mounted:function(){var i=this;this.token?(this.loading=!0,this.form.id=this.$route.params.id,o.a.single(this.form.id).then(function(t){var e=t.data;for(var r in e.files){i.form.title=r,i.form.content=e.files[r].content,i.form.description=e.description;break}}).then(function(){return i.loading=!1})):this.$nextTick(function(){i.$message({message:"权限不足",type:"error"}),i.$router.go(-1)})},methods:{imgAdd:function(t,e){this.$refs.md.$img2Url(t,e.miniurl)},onSubmit:function(){var t=this;this.token?this.publish():this.$refs.tokenDialog.open(function(){t.publish()})},publish:function(){var r=this;this.$refs.form.validate(function(t){t&&(r.submitButton.loading=!0,r.submitButton.disabled=!0,o.a.edit(r.form).then(function(t){var e=t.data;r.$message({message:"发表成功",type:"success"}),r.$router.push("/archives/create/detail/"+e.id)}).then(function(){r.submitButton.loading=!1,r.submitButton.disabled=!1}))})}}},u=r("JFUb"),c=Object(u.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"editTop",attrs:{"element-loading-text":"少女祈祷中..."}},[r("el-card",{staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"never"}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.ruleValidate}},[r("el-form-item",{attrs:{label:"标题",prop:"title"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"简要说明",prop:"description"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"博客正文",prop:"content"}},[r("mavon-editor",{ref:"md",attrs:{subfield:!1,toolbars:e.mavonEditorToolbars},on:{imgAdd:e.imgAdd},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.submitButton.loading,disabled:e.submitButton.disabled},on:{click:e.onSubmit}},[e._v("修改")]),e._v(" "),r("el-button",{on:{click:function(t){return e.$router.push("/archives/create")}}},[e._v("返回")])],1)],1)],1),e._v(" "),r("token-dialog",{ref:"tokenDialog"})],1)},[],!1,null,null,null);e.default=c.exports}}]);